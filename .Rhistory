if_else(month == "Setembro", "Sep",
if_else(month == "Novembro", "Nov",
if_else(month == "Outubro", "Oct", "Mar")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y") )
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "Apr",
if_else(month == "Agosto", "Aug",
if_else(month == "Dezembro", "Dec",
if_else(month == "Fevereiro", "Feb",
if_else(month == "Janeiro", "Jan",
if_else(month == "Julho", "Jul",
if_else(month == "Junho", "Jun",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "Sep",
if_else(month == "Novembro", "Nov",
if_else(month == "Outubro", "Oct", "Mar")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "Apr",
if_else(month == "Agosto", "Aug",
if_else(month == "Dezembro", "Dec",
if_else(month == "Fevereiro", "Feb",
if_else(month == "Janeiro", "Jan",
if_else(month == "Julho", "Jul",
if_else(month == "Junho", "Jun",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "Sep",
if_else(month == "Novembro", "Nov",
if_else(month == "Outubro", "Oct", "Mar")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"))
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"))
Sys.setlocale ("LC_TIME", 'English')
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"))
format(data_rio$new_date, "%B")
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"),
new_month = format(data_rio$new_date, "%B")) %>%
# group_by(new_date) %>%
# summarise(total = sum(as.integer(number)))
# spread(month,total) %>%
# select(Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec)
data_rio[is.na(data_rio)] <- 0
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"),
new_month = format(data_rio$new_date, "%B"))
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"),
new_month = format(data_rio$new_date, "%B")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
# ts_data_rio <- ts(data_rio, start = c(1998,1), frequency = 1)
fires_rio <- as_tsibble(data_rio, index = new_date, key=total)
fires_rio
fires_rio$
fires_rio %>%
autoplot(as.ts(total)) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
# ts_data_rio <- ts(data_rio, start = c(1998,1), frequency = 1)
fires_rio <- as_tsibble(data_rio, index = new_date, key=total)
fires_rio$
fires_rio %>%
autoplot(total) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
fires_rio$index
fires_rio$new_date
# ts_data_rio <- ts(data_rio, start = c(1998,1), frequency = 1)
fires_rio <- as_tsibble(data_rio, index = new_date)
fires_rio
fires_rio$new_date
total
fires_rio %>%
autoplot(total) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
total
fires_rio
library(tsibble)
library(ggplot2)
library(dplyr)
library(tidyr)
library(zoo)
data <- read.csv("amazon.csv")
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"),
new_month = format(data_rio$new_date, "%B")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
# spread(month,total) %>%
# select(Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec)
data_rio[is.na(data_rio)] <- 0
# ts_data_rio <- ts(data_rio, start = c(1998,1), frequency = 1)
fires_rio <- as_tsibble(data_rio, index = new_date)
fires_rio$new_date
fires_rio %>%
autoplot(total) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"),
new_month = format(data_rio$new_date, "%B")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y"),
new_month = format(data_rio$new_date, "%B")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
View(data_rio)
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
library(tsibble)
library(ggplot2)
library(dplyr)
library(tidyr)
library(zoo)
data <- read.csv("amazon.csv")
data_rio <- data %>%
filter(state == "Rio") %>%
select(year, month, number) %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March")))))))))))) %>%
mutate(new_date = as.yearmon(paste(month, "-", year), "%B - %Y")) %>%
group_by(new_date) %>%
summarise(total = sum(as.integer(number)))
View(data_rio)
# ts_data_rio <- ts(data_rio, start = c(1998,1), frequency = 1)
fires_rio <- as_tsibble(data_rio, index = new_date)
View(fires_rio)
fires_rio$new_date
fires_rio %>%
autoplot(total) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
fires_rio %>%
autoplot() +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
fires_rio %>%
autoplot() +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
fires_rio %>%
autoplot(ts(total)) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
fires_rio %>%
autoplot(value) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
air %>%
plot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
air
fires_rio
fires_rio %>%
autoplot(total) +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
air %>%
plot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passenge
air %>%
plot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
air %>%
plot(value)
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
air %>%
plot(value)
air
air$value
plot(air$value)
line(air$value)
plotline(air$value)
plot(air$value, type=l)
plot(air$value, type="l")
autoplot(air$value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
library(survival)
survfit(air$value)
survfit(air)
survfit(ts(air))
survfit(AirPassengers)
survfit(data.frame(AirPassengers))
---
title: "Machine learning I"
author: "Natalia Alonso, Beatriz Visitación y Susana Albarrán"
date: "30/04/2020"
output:
html_document:
code_folding: show
number_sections: yes
fig_height: 5
fig_width: 8
theme: flatly
toc: yes
toc_float: yes
pdf_document:
toc: yes
fig_caption: yes
---
```{r, lectura_datos, include=FALSE}
data <- read.csv("amazon.csv")
```
```{r, setup, include=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(ggplot2)
```
# Introducción
<p style = "text-align: justify">
</p>
# Objetivo del estudio
<p style = "text-align: justify">
Predecir el número de reservas mensual.
</p>
# Datos
<p style = "text-align: justify">
</p>
```{r, fig.align='center', warning=FALSE}
# SUMMARY DE LOS DATOS
date <- as.Date(data$date)
maxima <- max(date)
maxima
minimo <- min(date)
minimo
summary(data)
```
```{r}
# FILTRO POR ESTADO ACRE
library(zoo)
data_acre <- data[data$state == "Acre",]
data_acre <- data_acre %>%
mutate(month = if_else(month == "Abril", "April",
if_else(month == "Agosto", "August",
if_else(month == "Dezembro", "December",
if_else(month == "Fevereiro", "February",
if_else(month == "Janeiro", "January",
if_else(month == "Julho", "July",
if_else(month == "Junho", "June",
if_else(month == "Maio", "May",
if_else(month == "Setembro", "September",
if_else(month == "Novembro", "November",
if_else(month == "Outubro", "October", "March"))))))))))))
Sys.setlocale ("LC_TIME", 'English')
data_acre$new_date <- as.Date(paste("01", "-", data_acre$month, "-", data_acre$year), c("%d - %B - %Y"))
data_acre_simplif <- data_acre %>%
select(number, new_date) %>%
arrange(new_date)
tsData_acre <- ts(data_acre_simplif$number, start = c(1998,1), frequency = 12)
componentes_ts = decompose(tsData_acre)
plot(componentes_ts)
# PRUEBA CON LA LIBRERÍA XTS QUE ES MÁS COMPLETA
library(xts)
library(timeSeries)
x <- timeSeries(data_acre_2015_2016_simplif$number, data_acre_2015_2016_simplif$new_date)
matrix_xts <- as.xts(x)
str(matrix_xts)
plot(matrix_xts[,1])
```
<p style = "text-align: justify">
</p>
```{r, fig.align='center', warning=FALSE}
library("fUnitRoots")
plot(componentes_ts)
urkpssTest(tsData_acre, type = c("tau"), lags = c("short"),use.lag = NULL, doplot = TRUE)
tsstationary = diff(tsData_acre, differences=1)
plot(tsstationary)
acf(tsData_acre,lag.max=140)
ts_seasonally_adjusted <- tsData_acre-componentes_ts$seasonal
tsstationary <- diff(ts_seasonally_adjusted, differences=1)
plot(tsstationary)
acf(tsstationary, lag.max=140)
pacf(tsstationary, lag.max=140)
library(lmtest)
fitARIMA <- arima(tsData_acre, order=c(1,1,1),seasonal = list(order = c(1,0,0), period = 12),method="ML")
fitARIMA
coeftest(fitARIMA)
confint(fitARIMA)
```
```{r, fig.align='center', warning=FALSE}
```
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
# ts_data_rio <- ts(data_rio, start = c(1998,1), frequency = 1)
fires_rio <- as_tsibble(data_rio, index = new_date)
ts_fires <- ts(fires_rio$total, start = c(1998,1), frequency = 1)
ts_fires
ts_fires %>%
autoplot() +
labs(title = "Monthly totals of fires in Rio") +
xlab("Year") + ylab("Fires")
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(AirPassengers)
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
air = as_tsibble(AirPassengers, index = date)
air$index
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
air = as_tsibble(AirPassengers, index = date)
air$index
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
class(air$value)
AirPassengers
air = as_tsibble(AirPassengers, index = date)
air$index
class(air$value)
air %>%
autoplot(value) +
labs(title = "Monthly totals of international airline passengers") +
xlab("Year") + ylab("passengers")
class(air$value)
